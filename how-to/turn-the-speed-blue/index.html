<!DOCTYPE html>

<html data-theme="comma">
    <head>
        

        
        <link rel="preconnect" href="https://fonts.bunny.net">
        <link href="https://fonts.bunny.net/css?family=inter:400,700|roboto+mono:400&display=swap" rel="stylesheet" />

        
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">

            
            
              <link rel="canonical" href="https://docs.comma.ai/how-to/turn-the-speed-blue/" />
            

            
            
              <link rel="prev" href="../../getting-started/what-is-openpilot/" />
            

            
            
              <link rel="next" href="../connect-to-comma/" />
            
        


    
    
    
        <title>Turn the speed blue - openpilot</title>
    
    

    
    
        
        <link rel="stylesheet" href="../../assets/stylesheets/output.css"></link>
    

    
    

    
    

    
    
  </head>

  
  <body>
      <div class="xl:max-w-none">
            <div class="drawer lg:drawer-open">
                <input id="drawer" type="checkbox" class="drawer-toggle" />
                <div class="drawer-content flex flex-col">
                    
                    <div class="bg-base-100/80 backdrop-blur border-b-2 border-neutral sticky top-0 text-base-content justify-center">
    <div class="navbar">
        <div class="navbar-start">
            
            <div class="flex-none">
                <label
                    for="drawer"
                    aria-label="open sidebar"
                    class="btn bg-accent lg:hidden"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        class="h-6 w-6 stroke-black"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="3"
                            d="M4 6h16M4 12h16M4 18h16"
                        ></path>
                    </svg>
                </label>
            </div>

            
            <div class="indicator">
                
                    <div class="skew-y-3 indicator-item badge badge-accent badge-xs lg:badge-sm font-mono">
                        0.9.7
                    </div>
                <div class="px-2 font-bold lowercase text-xl lg:text-2xl">
                    openpilot
                </div>
            </div>
        </div>

        <div class="navbar-end">
            

            
            <div class="flex-none invisible sm:visible">
                <ul class="menu menu-horizontal px-1">
    
    
    <li>
        <a
            href="https://github.com/commaai/openpilot"
            title="GitHub Repo"
            target="_blank"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                class="stroke-current  fill-neutral h-6 w-6"
            >
                <path
                    d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"
                />
            </svg>
        </a>
    </li>
    
    
    
    <li>
        <a
            href="https://discord.comma.ai"
            target="_blank"
        >
            <svg
                role="img"
                viewBox="0 0 24 24"
                class="stroke-current fill-neutral h-6 w-6"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"
                />
            </svg>
        </a>
    </li>
    
</ul>
            </div>

            
        </div>
    </div>
</div>
                    
                    
<div class="px-6 pb-16 xl:pr-8">
    <div class="flex flex-col-reverse justify-between xl:flex-row">
        <div class="prose max-w-auto md:max-w-none
            prose-headings:font-monument-extended
            prose-a:decoration-accent prose-a:bg-gradient-to-l from-accent/30
            hover:prose-a:bg-accent/30 hover:prose-a:decoration-2
            w-full max-w-4xl flex-grow pt-10">
            
            <h1 id="turn-the-speed-blue">Turn the speed blue</h1>
<p><em>A getting started guide for openpilot development</em></p>
<p>In 30 minutes, we'll get an openpilot development environment setup on your computer and make some changes to openpilot's UI.</p>
<p>And if you have a comma 3/3X, we'll deploy the change to your device for testing.</p>
<h2 id="1-setup-your-development-environment">1. Setup your development environment</h2>
<p>Run this to clone openpilot and install all the dependencies:</p>
<pre><code class="language-bash">bash &lt;(curl -fsSL openpilot.comma.ai)
</code></pre>
<p>Navigate to openpilot folder &amp; activate a Python virtual environment</p>
<pre><code class="language-bash">cd openpilot
source .venv/bin/activate
</code></pre>
<p>Then, compile openpilot:</p>
<pre><code class="language-bash">scons -j8
</code></pre>
<h2 id="2-run-replay">2. Run replay</h2>
<p>We'll run the <code>replay</code> tool with the demo route to get data streaming for testing our UI changes.</p>
<pre><code class="language-bash"># in terminal 1
tools/replay/replay --demo

# in terminal 2
selfdrive/ui/ui
</code></pre>
<p>The openpilot UI should launch and show a replay of the demo route.</p>
<p>If you have your own comma device, you can replace <code>--demo</code> with one of your own routes from comma connect.</p>
<h2 id="3-make-the-speed-blue">3. Make the speed blue</h2>
<p>Search for “mph” with git grep in the <code>ui</code> folder.</p>
<pre><code class="language-bash">$ git grep &quot;mph&quot; selfdrive/ui/
paint.cc:  ui_draw_text(s, s-&gt;fb_w/2, 290, s-&gt;scene.is_metric ? &quot;km/h&quot; : &quot;mph&quot;, 36 * 2.5, COLOR_WHITE_ALPHA(200), &quot;sans-regular&quot;);
</code></pre>
<p>The line right above contains the actual speed. Unfortunately, COLOR_BLUE isn’t defined, but a git grep of COLOR_WHITE shows it’s nvgRGBA(255, 255, 255, 255). Personally, I like a lighter blue, so I went with #8080FF.</p>
<pre><code class="language-bash">$ git diff
diff --git a/selfdrive/ui/paint.cc b/selfdrive/ui/paint.cc
index 821d95115..cc996eaa1 100644
--- a/selfdrive/ui/paint.cc
+++ b/selfdrive/ui/paint.cc
@@ -175,8 +175,8 @@ static void ui_draw_vision_speed(UIState *s) {
   const float speed = std::max(0.0, (*s-&gt;sm)[&quot;carState&quot;].getCarState().getVEgo() * (s-&gt;scene.is_metric ? 3.6 : 2.2369363));
   const std::string speed_str = std::to_string((int)std::nearbyint(speed));
   nvgTextAlign(s-&gt;vg, NVG_ALIGN_CENTER | NVG_ALIGN_BASELINE);
-  ui_draw_text(s, s-&gt;fb_w/2, 210, speed_str.c_str(), 96 * 2.5, COLOR_WHITE, &quot;sans-bold&quot;);
-  ui_draw_text(s, s-&gt;fb_w/2, 290, s-&gt;scene.is_metric ? &quot;km/h&quot; : &quot;mph&quot;, 36 * 2.5, COLOR_WHITE_ALPHA(200), &quot;sans-regular&quot;);
+  ui_draw_text(s, s-&gt;fb_w/2, 210, speed_str.c_str(), 96 * 2.5, nvgRGBA(128, 128, 255, 255), &quot;sans-bold&quot;);
+  ui_draw_text(s, s-&gt;fb_w/2, 290, s-&gt;scene.is_metric ? &quot;km/h&quot; : &quot;mph&quot;, 36 * 2.5, nvgRGBA(128, 128, 255, 200), &quot;sans-regular&quot;);
 }

 static void ui_draw_vision_event(UIState *s) {
</code></pre>
<h2 id="4-rebuild-ui-and-admire-your-work">4. Rebuild UI, and admire your work</h2>
<pre><code>scons -j8 &amp;&amp; selfdrive/ui/ui
</code></pre>
<p><img alt="" src="https://blog.comma.ai/img/blue_speed_ui.png" /></p>
<h2 id="5-push-your-fork-to-github">5. Push your fork to GitHub</h2>
<p>Click fork on GitHub. Then, push with:</p>
<pre><code class="language-bash">git remote rm origin
git remote add origin git@github.com:&lt;your-github-username&gt;/openpilot.git
git add .
git commit -m &quot;Make the speed blue.&quot;
git push --set-upstream origin master
</code></pre>
<h2 id="6-run-your-fork-on-device-in-your-car">6. Run your fork on device in your car!</h2>
<p>Uninstall openpilot from your device through the settings. Then, enter the URL for your very own installer:</p>
<pre><code>installer.comma.ai/&lt;your-github-username&gt;/master
</code></pre>
<h2 id="7-admire-your-work-irl">7. Admire your work IRL</h2>
<p><img alt="" src="https://blog.comma.ai/img/c3_blue_ui.jpg" /></p>
        </div>

        
    </div>
</div>
                </div>
                
                <div class="drawer-side" style="scroll-behavior: smooth; scroll-padding-top: 5rem;">
                    <label for="drawer" aria-label="close sidebar" class="drawer-overlay"></label>
                    <ul class="menu bg-base-100 min-h-full w-70 p-4 border-r-2 border-neutral shadow-none">
    <div class="flex flex-col items-center justify-center space-y-2">
        
        <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 -0.25 24 24"
            fill="black"
            stroke="white"
            stroke-width="1"
            paint-order="stroke"
            class="h-8 w-8"
        >
            <path
                d="M6.72682 24c0-.55531-.0434-1.02051.02045-1.46891.0272-.1912.25037-.39595.43237-.51143.88731-.56315 1.85122-1.01275 2.67734-1.65857 2.67584-2.09206 4.26201-4.84612 4.3487-8.42366.02452-1.01583-.34891-1.2696-1.20211-.87389-2.4628 1.1424-5.11119.47263-6.5246-1.65034-1.54137-2.3155-1.32431-5.3984.52253-7.4211 2.359-2.58344 6.24053-2.66074 8.91722-.19346 1.60337 1.47794 2.3652 3.38627 2.5552 5.5569.63691 7.27188-3.01046 13.2657-9.64881 15.89874-.657.26045-1.3307.4744-2.09828.74571"
            />
        </svg>
    </div>

    <div class="h-4"></div>
    
        <ul class="menu px-4 py-0 flex">
        
            
                <li>
                    <details >
                    <summary class="font-inter font-bold">Getting Started</summary>
                    <ul>
                    
                        <li class="">
                            <a href="../../getting-started/what-is-openpilot/" class="hover:bg-accent hover:text-accent-content">What is openpilot?</a>
                      </li>
                    
                    </ul>
                    </details>
                </li>
            
        
            
                <li>
                    <details open>
                    <summary class="font-inter font-bold">How-to</summary>
                    <ul>
                    
                        <li class="bg-neutral text-neutral-content">
                            <a href="./" class="hover:bg-accent hover:text-accent-content">Turn the speed blue</a>
                      </li>
                    
                        <li class="">
                            <a href="../connect-to-comma/" class="hover:bg-accent hover:text-accent-content">Connect to a comma 3/3X</a>
                      </li>
                    
                    </ul>
                    </details>
                </li>
            
        
            
                <li>
                    <details >
                    <summary class="font-inter font-bold">Concepts</summary>
                    <ul>
                    
                        <li class="">
                            <a href="../../concepts/logs/" class="hover:bg-accent hover:text-accent-content">Logs</a>
                      </li>
                    
                        <li class="">
                            <a href="../../concepts/safety/" class="hover:bg-accent hover:text-accent-content">Safety</a>
                      </li>
                    
                    </ul>
                    </details>
                </li>
            
        
            
                <li>
                    <details >
                    <summary class="font-inter font-bold">Car Porting</summary>
                    <ul>
                    
                        <li class="">
                            <a href="../../car-porting/what-is-a-car-port/" class="hover:bg-accent hover:text-accent-content">What is a car port?</a>
                      </li>
                    
                        <li class="">
                            <a href="../../car-porting/brand-port/" class="hover:bg-accent hover:text-accent-content">Porting a car brand</a>
                      </li>
                    
                        <li class="">
                            <a href="../../car-porting/model-port/" class="hover:bg-accent hover:text-accent-content">Porting a car model</a>
                      </li>
                    
                    </ul>
                    </details>
                </li>
            
        
            
                <li>
                    <details >
                    <summary class="font-inter font-bold">Contributing</summary>
                    <ul>
                    
                        <li class="">
                            <a href="../../contributing/roadmap/" class="hover:bg-accent hover:text-accent-content">Roadmap</a>
                      </li>
                    
                        <li class="">
                            <a href="https://github.com/commaai/openpilot/blob/master/docs/CONTRIBUTING.md" class="hover:bg-accent hover:text-accent-content">Contributing Guide →</a>
                      </li>
                    
                    </ul>
                    </details>
                </li>
            
        
            
                <li>
                    <details >
                    <summary class="font-inter font-bold">Links</summary>
                    <ul>
                    
                        <li class="">
                            <a href="https://blog.comma.ai" class="hover:bg-accent hover:text-accent-content">Blog →</a>
                      </li>
                    
                        <li class="">
                            <a href="https://comma.ai/bounties" class="hover:bg-accent hover:text-accent-content">Bounties →</a>
                      </li>
                    
                        <li class="">
                            <a href="https://github.com/commaai" class="hover:bg-accent hover:text-accent-content">GitHub →</a>
                      </li>
                    
                        <li class="">
                            <a href="https://discord.comma.ai" class="hover:bg-accent hover:text-accent-content">Discord →</a>
                      </li>
                    
                        <li class="">
                            <a href="https://x.com/comma_ai" class="hover:bg-accent hover:text-accent-content">X →</a>
                      </li>
                    
                    </ul>
                    </details>
                </li>
            
        
        </ul>
    
    <div class="bg-base-100 pointer-events-none sticky bottom-0 flex h-40 [mask-image:linear-gradient(transparent,#000000)]"></div>
</ul>
                </div>
            </div>

            
        </div>
  </body>
</html>